<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" href="favicon.png" type="image/x-icon">
    <title>Gerenciador de Produtos</title>
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/style.css">
</head>

<body>
    <div id="messageBox" class="message-box"></div>

    <div class="container">
        <h1 class="sr-only">Gerenciador de Produtos</h1>

        <div class="tab-buttons">
            <button class="tab-button active" onclick="showSection('consultation')">Consulta</button>
            <button class="tab-button" onclick="showSection('registration')">Cadastro</button>
            <button class="tab-button" onclick="showSection('data-management')">Dados</button>
        </div>

        <!-- Seção de Consulta de Produtos -->
        <div id="consultationSection" class="form-section active">
            <div class="search-bar-container">
                <input type="text" id="searchBar" placeholder="Buscar produtos..." class="mb-2">
                <fieldset>
                    <legend>Buscar por:</legend>
                    <div>
                        <input type="radio" id="name" name="searchBy" value="name" checked />
                        <label for="name">Nome</label>
                    </div>
                    <div>
                        <input type="radio" id="category" name="searchBy" value="category" />
                        <label for="category">Categoria</label>
                    </div>
                    <div>
                        <input type="radio" id="details" name="searchBy" value="details" />
                        <label for="details">Detalhes</label>
                    </div>
                </fieldset>
            </div>

            <div id="productList" class="product-grid">
                <!-- Produtos serão listados aqui -->
            </div>
        </div>

        <!-- Seção de Cadastro de Produtos -->
        <div id="registrationSection" class="form-section">
            <h2 class="text-2xl font-semibold text-gray-700 mb-4">Cadastrar / Atualizar Produto</h2>
            <input type="hidden" id="productId">
            <input type="text" id="productName" placeholder="Nome do Produto" required>
            <input type="text" id="productCategory" placeholder="Categoria (ex: Bebidas, Mercearia)">
            <input type="text" id="productBrand" placeholder="Marca">
            <input type="text" id="productDetails" placeholder="Detalhes (ex: Latinha, Zero)">
            <input type="text" id="productMeasure" placeholder="Medida (ex: 600 ml, 2L)">
            <input type="number" id="productPrice" placeholder="Preço" step="0.01" required>
            <button onclick="saveProduct()">Salvar Produto</button>
            <button onclick="clearForm()" class="secondary">Limpar Formulário</button>
        </div>

        <!-- Seção de Gestão de Dados -->
        <div id="data-managementSection" class="form-section">
            <h2 class="text-2xl font-semibold text-gray-700 mb-4">Gestão de Dados</h2>
            <button onclick="exportData()">Exportar Dados (JSON)</button>
            <div class="fixed bottom-0 left-0 p-4 w-full">
                <input type="file" id="importFile" accept=".json" class="mt-[1rem] mb-2 p-2 border rounded-md">
                <button onclick="importData()" class="w-full">Importar Dados</button>
                <button onclick="loadDemoData()" class="w-full">Carregar Dados Demonstrativos</button>
                <button onclick="confirmClearData()" class="danger mt-4">Limpar Todos os Dados</button>
            </div>
        </div>
    </div>

    <script>
        const STORAGE_KEY = 'product_manager_data';
        const NOW = new Date();
        let products = [];
        let scrollToTopBtn;

        // Dados de demonstração embutidos
        const demoProducts = [
            {
                id: 'demo-1',
                name: "Cerveja 600 ml",
                category: "Bebidas",
                brand: null,
                details: null,
                measure: "600 ml",
                price: 6.5,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-2',
                name: "Cerveja latinha",
                category: "Bebidas",
                brand: null,
                details: "Latinha",
                measure: null,
                price: 4,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-3',
                name: "Cerveja Petra",
                category: "Bebidas",
                brand: "Petra",
                details: null,
                measure: null,
                price: 5,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-4',
                name: "Cerveja Devassa",
                category: "Bebidas",
                brand: "Devassa",
                details: null,
                measure: null,
                price: 5,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-5',
                name: "Cerveja latão",
                category: "Bebidas",
                brand: null,
                details: "Latão",
                measure: null,
                price: 6,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-6',
                name: "Cerveja Skol latão",
                category: "Bebidas",
                brand: "Skol",
                details: "Latão",
                measure: null,
                price: 6.5,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-7',
                name: "Cerveja Skol latinha",
                category: "Bebidas",
                brand: "Skol",
                details: "Latinha",
                measure: null,
                price: 4.5,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-8',
                name: "Cerveja Itaipava Zero",
                category: "Bebidas",
                brand: "Itaipava",
                details: "Zero",
                measure: null,
                price: 5,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-9',
                name: "Cerveja Itaipava latão",
                category: "Bebidas",
                brand: "Itaipava",
                details: "Latão",
                measure: null,
                price: 6,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-10',
                name: "Cerveja Itaipava latinha",
                category: "Bebidas",
                brand: "Itaipava",
                details: "latinha",
                measure: null,
                price: 4,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-11',
                name: "Cerveja Itaipava Garrafa",
                category: "Bebidas",
                brand: "Itaipava",
                details: "Garrafa",
                measure: "Garrafa 600 ml",
                price: 6.5,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-12',
                name: "Cerveja Skol latinha",
                category: "Bebidas",
                brand: "Skol",
                details: "latinha",
                measure: null,
                price: 4,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-13',
                name: "Cerveja Itaipava sem álcool",
                category: "Bebidas",
                brand: "Itaipava",
                details: "Sem álcool",
                measure: null,
                price: 5,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-14',
                name: "Refrigerante Genérico 2L",
                category: "Bebidas",
                brand: null,
                details: null,
                measure: "2L",
                price: 7,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-15',
                name: "Refrigerante Coca-Cola 2,5L",
                category: "Bebidas",
                brand: "Coca-Cola",
                details: null,
                measure: "2,5L",
                price: 13,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-16',
                name: "Refrigerante Coca-Cola 2L",
                category: "Bebidas",
                brand: "Coca-Cola",
                details: null,
                measure: "2L",
                price: 12,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-17',
                name: "Refrigerante Coca-Cola 250 ml",
                category: "Bebidas",
                brand: "Coca-Cola",
                details: null,
                measure: "250 ml",
                price: 3,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-18',
                name: "Refrigerante Genérico 250 ml",
                category: "Bebidas",
                brand: null,
                details: null,
                measure: "250 ml",
                price: 2.5,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-19',
                name: "Refrigerante Genérico lata",
                category: "Bebidas",
                brand: null,
                details: "lata",
                measure: null,
                price: 4,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-20',
                name: "Refrigerante H2oh",
                category: "Bebidas",
                brand: "H2oh",
                details: null,
                measure: null,
                price: 7,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-21',
                name: "Refrigerante Genérico 1L",
                category: "Bebidas",
                brand: null,
                details: null,
                measure: "1L",
                price: 6,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-22',
                name: "Refrigerante Coca-Cola 1L",
                category: "Bebidas",
                brand: "Coca-Cola",
                details: null,
                measure: "1L",
                price: 7,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-23',
                name: "Iogurte 1L",
                category: "Bebidas",
                brand: null,
                details: null,
                measure: "1L",
                price: 7.5,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-24',
                name: "Iogurte 450 ml",
                category: "Bebidas",
                brand: null,
                details: null,
                measure: "450 ml",
                price: 5.5,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-25',
                name: "Iogurte 180 ml",
                category: "Bebidas",
                brand: null,
                details: null,
                measure: null,
                price: 3,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-26',
                name: "Iogurte Chupetinha",
                category: "Bebidas",
                brand: null,
                details: "Chupetinha",
                measure: null,
                price: 1.5,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-27',
                name: "Cerveja Heineken",
                category: "Bebidas",
                brand: "Heineken",
                details: null,
                measure: null,
                price: 7,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-28',
                name: "Água 1,5L",
                category: "Bebidas",
                brand: null,
                details: null,
                measure: "1,5L",
                price: 4,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-29',
                name: "Água sem gás",
                category: "Bebidas",
                brand: null,
                details: "Sem gás",
                measure: null,
                price: 2.5,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-30',
                name: "Água com gás",
                category: "Bebidas",
                brand: null,
                details: "Com gás",
                measure: null,
                price: 3,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-31',
                name: "Água (troca galão)",
                category: "Bebidas",
                brand: null,
                details: "Na troca do galão",
                measure: "Galão",
                price: 0,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-32',
                name: "Água (venda com galão)",
                category: "Bebidas",
                brand: null,
                details: "Com galão",
                measure: null,
                price: 0,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-33',
                name: "Agua 1,5L",
                category: "Bebidas",
                brand: null,
                details: null,
                measure: "1,5L",
                price: 4,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-34',
                name: "Agua sem gás",
                category: "Bebidas",
                brand: null,
                details: "Sem gás",
                measure: null,
                price: 2.5,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-35',
                name: "Agua com gás",
                category: "Bebidas",
                brand: null,
                details: "Com gás",
                measure: null,
                price: 3,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-36',
                name: "Agua (troca galão)",
                category: "Bebidas",
                brand: null,
                details: "Na troca do galão",
                measure: "Galão",
                price: 0,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-37',
                name: "Agua (venda com galão)",
                category: "Bebidas",
                brand: null,
                details: "Com galão",
                measure: null,
                price: 0,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-38',
                name: "Energético TNT pequeno",
                category: "Bebidas",
                brand: "TNT",
                details: "Pequeno",
                measure: null,
                price: 10,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-39',
                name: "Energético TNT grande",
                category: "Bebidas",
                brand: "TNT",
                details: "Grande",
                measure: null,
                price: 12,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-40',
                name: "Conhaque à dose",
                category: "Bebidas",
                brand: null,
                details: "Venda à dose",
                measure: "Dose",
                price: 4,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-41',
                name: "Pinga à dose",
                category: "Bebidas",
                brand: null,
                details: "Venda à dose",
                measure: "Dose",
                price: 3,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-42',
                name: "Montila à dose",
                category: null,
                brand: null,
                details: "Venda à dose",
                measure: "Dose",
                price: 4,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-43',
                name: "Guarathon 290 ml",
                category: "Bebidas",
                brand: "Guarathon",
                details: null,
                measure: "290 ml",
                price: 2.5,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-44',
                name: "Achocolatado Maratinho 200 ml",
                category: "Bebidas",
                brand: "Maratinho",
                details: null,
                measure: "200 ml",
                price: 2.5,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-45',
                name: "Achocolatado Italakinho 200 ml",
                category: "Bebidas",
                brand: "Italakinho",
                details: null,
                measure: "200 ml",
                price: 2.5,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-46',
                name: "Achocolatado Nescau 180 ml",
                category: "Bebidas",
                brand: "Nescau",
                details: null,
                measure: "180 ml",
                price: 3,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-47',
                name: "Energético Red Bull 250 ml",
                category: "Bebidas",
                brand: "Red Bull",
                details: null,
                measure: "250 ml",
                price: 12,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-48',
                name: "Açúcar",
                category: "Mercearia",
                brand: null,
                details: null,
                measure: null,
                price: 5.5,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-49',
                name: "Coco Ralado Bahia 50g",
                category: "Mercearia",
                brand: "Bahia",
                details: null,
                measure: "50g",
                price: 5.5,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-50',
                name: "Milho enlatado",
                category: "Mercearia",
                brand: null,
                details: null,
                measure: "Lata",
                price: 6.7,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-51',
                name: "Milho para pipoca",
                category: "Mercearia",
                brand: "Kicaldo",
                details: null,
                measure: "500g",
                price: 6.5,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-52',
                name: "Ervilha enlatada Bonare",
                category: "Mercearia",
                brand: "Bonare",
                details: null,
                measure: "Lata",
                price: 5.7,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-53',
                name: "Amendoim",
                category: "Salgados",
                brand: null,
                details: null,
                measure: null,
                price: 2,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-54',
                name: "Babaloo",
                category: "Doces",
                brand: null,
                details: null,
                measure: null,
                price: 0.5,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-55',
                name: "Bala Canela",
                category: "Doces",
                brand: null,
                details: null,
                measure: null,
                price: 0.25,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-56',
                name: "Bala Comum",
                category: "Doces",
                brand: null,
                details: null,
                measure: null,
                price: 0.15,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-57',
                name: "Bala Goma (Jujuba)",
                category: "Doces",
                brand: null,
                details: "Balinha goma colorida",
                measure: null,
                price: 1.5,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-58',
                name: "Bala Hortelã",
                category: "Doces",
                brand: null,
                details: null,
                measure: null,
                price: 0.2,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-59',
                name: "Bauru",
                category: "Salgados",
                brand: null,
                details: null,
                measure: null,
                price: 4,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-60',
                name: "Chiclete Big Big",
                category: "Doces",
                brand: "Big Big",
                details: null,
                measure: null,
                price: 0.5,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-61',
                name: "Biscoito de povilho",
                category: "Bolachas e Biscoitos",
                brand: null,
                details: null,
                measure: null,
                price: 5,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-62',
                name: "Biscoito palito açucarado",
                category: "Bolachas e Biscoitos",
                brand: null,
                details: null,
                measure: null,
                price: 5,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-63',
                name: "Bolacha Recheada",
                category: "Bolachas e Biscoitos",
                brand: null,
                details: null,
                measure: null,
                price: 3,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-64',
                name: "Bolacha Cream-Cracker",
                category: "Bolachas e Biscoitos",
                brand: "Cream-Cracker",
                details: null,
                measure: null,
                price: 8.5,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-65',
                name: "Bolacha Vitarella Maizena",
                category: "Bolachas e Biscoitos",
                brand: "Vitarella",
                details: null,
                measure: null,
                price: 8.5,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-66',
                name: "Biscoito Vitarella Maria Tradicional",
                category: "Bolachas e Biscoitos",
                brand: "Vitarella",
                details: null,
                measure: null,
                price: 8.5,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-67',
                name: "Bolacha Brandini Maria",
                category: "Bolachas e Biscoitos",
                brand: "Brandini",
                details: null,
                measure: null,
                price: 8.5,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-68',
                name: "Bolo inteiro",
                category: "Lanches",
                brand: null,
                details: null,
                measure: "Inteiro",
                price: 10,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-69',
                name: "Bolo milho (fatia)",
                category: "Lanches",
                brand: null,
                details: null,
                measure: "Fatia",
                price: 4,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-70',
                name: "Broa (pacote)",
                category: "Bolachas e Biscoitos",
                brand: null,
                details: null,
                measure: "Pacote",
                price: 5,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-71',
                name: "Chocolate Cacauzinho",
                category: "Doces",
                brand: "Cacauzinho",
                details: null,
                measure: null,
                price: 1.5,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-72',
                name: "Café puro (meio copo)",
                category: "Lanches",
                brand: null,
                details: null,
                measure: "Meio copo",
                price: 1,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-73',
                name: "Café com leite (copo cheio)",
                category: "Lanches",
                brand: null,
                details: null,
                measure: "Copo cheio",
                price: 2,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-74',
                name: "Bombom (caixa)",
                category: "Doces",
                brand: null,
                details: null,
                measure: null,
                price: 17,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-75',
                name: "Chiclete Big Big",
                category: null,
                brand: null,
                details: null,
                measure: null,
                price: 999,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-76',
                name: "Chocolate (barrinha)",
                category: "Doces",
                brand: null,
                details: null,
                measure: "Barrinha",
                price: 3,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-77',
                name: "Cortes Temperados Avinor",
                category: "Frios",
                brand: "Avinor",
                details: null,
                measure: null,
                price: 25.5,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-78',
                name: "Coxa e sobrecoxa Pif-Paf",
                category: "Frios",
                brand: "Pif-Paf",
                details: "Pesar",
                measure: null,
                price: 19.5,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-79',
                name: "Esponja lava louças",
                category: "Limpeza e Higiene",
                brand: null,
                details: null,
                measure: null,
                price: 1.5,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-81',
                name: "Filé de peito de frango",
                category: "Frios",
                brand: null,
                details: "Já pesado",
                measure: null,
                price: 28.75,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-82',
                name: "Miojo Marata Lámen",
                category: "Mercearia",
                brand: "Marata",
                details: null,
                measure: null,
                price: 2,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-83',
                name: "Frango congelado",
                category: "Frios",
                brand: null,
                details: "Pesar",
                measure: "O quilo",
                price: 12.9,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-84',
                name: "Frango temperado Avinor",
                category: "Frios",
                brand: "Avinor",
                details: null,
                measure: null,
                price: null,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-85',
                name: "Frango a Passarinho",
                category: "Frios",
                brand: null,
                details: "Pesar",
                measure: "O quilo",
                price: 19.5,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-86',
                name: "Costela a Passarinho",
                category: "Frios",
                brand: null,
                details: "Pesar",
                measure: "O quilo",
                price: 28,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-87',
                name: "Mortadela",
                category: "Frios",
                brand: null,
                details: null,
                measure: "Rolo pequeno",
                price: 6,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-88',
                name: "Goiabada",
                category: "Mercearia",
                brand: null,
                details: null,
                measure: null,
                price: 3.8,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-89',
                name: "Macarrão Pilar",
                category: "Mercearia",
                brand: "Pilar",
                details: null,
                measure: null,
                price: 5,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-90',
                name: "Milharina Flocão",
                category: "Mercearia",
                brand: null,
                details: null,
                measure: null,
                price: 4,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-91',
                name: "Goma fresca de tapioca",
                category: "Mercearia",
                brand: null,
                details: null,
                measure: "Bloco",
                price: 8,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-92',
                name: "Bala Halls",
                category: "Doces",
                brand: "Halls",
                details: null,
                measure: null,
                price: 2.5,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-93',
                name: "Lâminas Barbear (caixinha)",
                category: "Limpeza e Higiene",
                brand: null,
                details: "Caixinha com 3 unidades",
                measure: "Caixa",
                price: 4.5,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-94',
                name: "Palitos Paraná Petiscos",
                category: "Limpeza e Higiene",
                brand: "Paraná",
                details: null,
                measure: null,
                price: 3,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-95',
                name: "Lâmina Barbear (unidade)",
                category: "Limpeza e Higiene",
                brand: null,
                details: null,
                measure: "Unidade",
                price: 1.5,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-96',
                name: "Isqueiro",
                category: "Utilidades",
                brand: null,
                details: null,
                measure: "Unidade",
                price: 6.5,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-97',
                name: "Cartão Suco Tang",
                category: "Sucos",
                brand: "Tang",
                details: null,
                measure: "Cartão",
                price: 1.5,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-98',
                name: "Geléia de Framboesa",
                category: "Mercearia",
                brand: null,
                details: null,
                measure: null,
                price: 22,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-99',
                name: "Leite Integral Natville (caixa)",
                category: "Mercearia",
                brand: "Natville",
                details: null,
                measure: "Caixa",
                price: 9,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-100',
                name: "Arrozina",
                category: "Mercearia",
                brand: null,
                details: null,
                measure: "Caixa",
                price: 7.7,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-101',
                name: "Leite Coco",
                category: "Mercearia",
                brand: null,
                details: null,
                measure: "Frasco",
                price: 5.5,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-102',
                name: "Catchup Tambau",
                category: "Mercearia",
                brand: "Tambau",
                details: null,
                measure: "Frasco 380g",
                price: 6.9,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-103',
                name: "Molho de Tomate Etti Tradicional",
                category: "Mercearia",
                brand: "Etti",
                details: null,
                measure: "Pacote",
                price: 4.5,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-104',
                name: "Mistura Leite Mococa",
                category: "Mercearia",
                brand: "Mococa",
                details: null,
                measure: "Caixa 200g",
                price: 5.5,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-105',
                name: "Leite Condensado Italac",
                category: "Mercearia",
                brand: "Italac",
                details: null,
                measure: "Caixa 395g",
                price: 8.5,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-106',
                name: "Azeite de Oliva Borges",
                category: "Mercearia",
                brand: "Borges",
                details: null,
                measure: "Garrafa",
                price: 35,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-107',
                name: "Sardinha 88",
                category: "Mercearia",
                brand: "88",
                details: null,
                measure: null,
                price: 6.8,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-108',
                name: "Vinagre Gota",
                category: "Mercearia",
                brand: "Gota",
                details: null,
                measure: null,
                price: 3.5,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-109',
                name: "Achocolatado Maratá",
                category: "Mercearia",
                brand: "Maratá",
                details: null,
                measure: "Pacote",
                price: 6,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-110',
                name: "Café pacote",
                category: "Mercearia",
                brand: null,
                details: null,
                measure: "Pacote",
                price: 10,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-111',
                name: "Leite em pó Piracanjuba",
                category: "Mercearia",
                brand: "Piracanjuba",
                details: null,
                measure: "Pacote",
                price: 13.5,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-112',
                name: "Mistura composto Lacteo",
                category: "Mercearia",
                brand: null,
                details: null,
                measure: "Pacote",
                price: 6,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-113',
                name: "Leite natural",
                category: "Mercearia",
                brand: null,
                details: "null",
                measure: "Saco 1L",
                price: 5,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-114',
                name: "Leite Ninho",
                category: "Mercearia",
                brand: "Ninho",
                details: null,
                measure: null,
                price: 27,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-115',
                name: "Linguiça mineira",
                category: "Frios",
                brand: null,
                details: "Pesar",
                measure: "O quilo",
                price: 27,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-116',
                name: "Margarina",
                category: "Mercearia",
                brand: null,
                details: null,
                measure: "Pote",
                price: 6,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-117',
                name: "Milho para pipoca",
                category: "Mercearia",
                brand: null,
                details: null,
                measure: null,
                price: 6.5,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-118',
                name: "Ovos (dúzia)",
                category: "Mercearia",
                brand: null,
                details: null,
                measure: "Dúzia",
                price: 12,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-119',
                name: "Ovos (cartela)",
                category: "Mercearia",
                brand: null,
                details: null,
                measure: "Cartela",
                price: 25,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-120',
                name: "Paçoca",
                category: "Doces",
                brand: null,
                details: null,
                measure: null,
                price: 1,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-121',
                name: "Paçoca cocada amendoim",
                category: "Doces",
                brand: null,
                details: null,
                measure: null,
                price: 3,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-122',
                name: "Papel higiênico Novo",
                category: "Limpeza e Higiene",
                brand: "Novo",
                details: null,
                measure: null,
                price: 5.5,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-123',
                name: "Papel higiênico Max / Velud",
                category: "Limpeza e Higiene",
                brand: "Max / Velud",
                details: null,
                measure: null,
                price: 8.5,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-124',
                name: "Pastel / Coxinha",
                category: "Lanches",
                brand: null,
                details: null,
                measure: null,
                price: 4,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-125',
                name: "Misto quente",
                category: "Lanches",
                brand: null,
                details: "Pão com queijo e presunto",
                measure: "Unidade",
                price: 5,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-126',
                name: "Pipoca pacotinho",
                category: "Doces",
                brand: null,
                details: null,
                measure: null,
                price: 2,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-127',
                name: "Pirulito grande",
                category: "Doces",
                brand: null,
                details: null,
                measure: null,
                price: 1.2,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-128',
                name: "Preservativo",
                category: null,
                brand: null,
                details: null,
                measure: null,
                price: 5.5,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-129',
                name: "Salgadinho Pururuca / Pelinha ",
                category: "Salgados",
                brand: null,
                details: null,
                measure: null,
                price: 2.5,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-130',
                name: "Pururuca / Pelinha (pacote transparente)",
                category: "Salgados",
                brand: null,
                details: null,
                measure: null,
                price: 2,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-131',
                name: "Queijo",
                category: "Mercearia",
                brand: null,
                details: null,
                measure: null,
                price: 22,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-132',
                name: "Sabão barrinha",
                category: "Limpeza e Higiene",
                brand: null,
                details: null,
                measure: "barra",
                price: 4,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-133',
                name: "Sabão barrinha coco",
                category: "Limpeza e Higiene",
                brand: null,
                details: null,
                measure: "barra",
                price: 5.5,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-134',
                name: "Sabão em pó OMO",
                category: "Limpeza e Higiene",
                brand: "OMO",
                details: null,
                measure: null,
                price: 11.9,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-135',
                name: "Sabão em pó Ala",
                category: "Limpeza e Higiene",
                brand: "Ala",
                details: null,
                measure: null,
                price: null,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-136',
                name: "Sabão Teiu",
                category: "Limpeza e Higiene",
                brand: "Teiu",
                details: null,
                measure: null,
                price: 7.5,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-137',
                name: "Sal",
                category: "Mercearia",
                brand: null,
                details: null,
                measure: null,
                price: 2.5,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-138',
                name: "Salgadinho batata",
                category: "Salgados",
                brand: null,
                details: null,
                measure: null,
                price: 3.5,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-139',
                name: "Salgadinho pacote amarelo",
                category: "Salgados",
                brand: null,
                details: null,
                measure: null,
                price: 2,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-140',
                name: "Salgadinho pacote menor",
                category: "Salgados",
                brand: null,
                details: null,
                measure: null,
                price: 1.5,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-141',
                name: "Salsicha",
                category: "Frios",
                brand: null,
                details: null,
                measure: null,
                price: 20,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-142',
                name: "Torta chocolate (fatia)",
                category: "Lanches",
                brand: null,
                details: null,
                measure: "Fatia",
                price: 5,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-143',
                name: "Chiclete Trident",
                category: "Doces",
                brand: "Trident",
                details: null,
                measure: null,
                price: 3,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-144',
                name: "Caldo Galinha Kinor",
                category: "Temperos",
                brand: "Kinor",
                details: null,
                measure: "Barrinha",
                price: 2,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-145',
                name: "Cimegripe",
                category: "Medicamentos",
                brand: "Cimegripe",
                details: null,
                measure: "Unidade",
                price: 2,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            },
            {
                id: 'demo-146',
                name: "Chinela / Sandália",
                category: "Calçados",
                brand: null,
                details: null,
                measure: null,
                price: 18,
                createdAt: "2025-06-05T03:00:00.000Z",
                updatedAt: null
            }
        ];

        function loadProducts() {
            const data = localStorage.getItem(STORAGE_KEY);
            if (data) {
                products = JSON.parse(data);
            }
            displayProducts(products);
        }

        function loadDemoData() {
            products = [...demoProducts];
            saveProducts();
            showMessage('Dados de demonstração carregados!');
        }

        function saveProducts() {
            localStorage.setItem(STORAGE_KEY, JSON.stringify(products));
        }

        function generateId() {
            return Date.now().toString(36) + Math.random().toString(36).substr(2, 5);
        }

        function showMessage(message, type = 'success') {
            const messageBox = document.getElementById('messageBox');
            messageBox.textContent = message;
            messageBox.className = `message-box show ${type}`;
            setTimeout(() => {
                messageBox.className = `message-box ${type}`;
                setTimeout(() => window.location.reload(), 600)
            }, 3000);
        }

        function toggleProductCard(productId) {
            const card = document.querySelector(`[data-product-id="${productId}"]`);
            if (card) {
                card.classList.toggle('expanded');
            }
        }

        function dateIsEarlierThanAMonthAgo(dateToCheck) {
            oneMonthAgo = new Date(NOW);
            oneMonthAgo.setMonth(oneMonthAgo.getMonth() - 1);
            return dateToCheck < oneMonthAgo.toISOString();
        }

        function dateIsEarlierThanThreeMonthsAgo(dateToCheck) {
            const threeMonthsAgo = new Date(NOW);
            threeMonthsAgo.setMonth(threeMonthsAgo.getMonth() - 3);
            return dateToCheck < threeMonthsAgo.toISOString();
        }

        function getProductDateStatus(createdAt, updatedAt) {
            if (updatedAt === null) {
                if (dateIsEarlierThanThreeMonthsAgo(createdAt)) {
                    return 'old';
                } else if (dateIsEarlierThanAMonthAgo(createdAt)) {
                    return 'avg';
                } else {
                    return 'new';
                }
            } else {
                if (dateIsEarlierThanThreeMonthsAgo(updatedAt)) {
                    return 'old';
                } else if (dateIsEarlierThanAMonthAgo(updatedAt)) {
                    return 'avg';
                } else {
                    return 'new';
                }
            }
        }

        function displayProducts(productsToDisplay) {
            const productList = document.getElementById('productList');
            productList.innerHTML = '';

            if (productsToDisplay.length === 0) {
                productList.innerHTML = `
                    <div class="empty-state" style="grid-column: 1 / -1;">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2 2v-5m16 0h-2M4 13h2m13-8V4a1 1 0 00-1-1H7a1 1 0 00-1 1v1m-1 8l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2"></path>
                        </svg>
                        <h3 style="font-size: 1.25rem; font-weight: 600; margin-bottom: 0.5rem;">Nenhum produto encontrado</h3>
                        <p>Tente ajustar os filtros de busca ou adicione novos produtos.</p>
                    </div>
                `;
                return;
            }

            productsToDisplay.sort((a, b) => {
                const nameA = (a.name || '').toLowerCase();
                const nameB = (b.name || '').toLowerCase();
                return nameA.localeCompare(nameB);
            });

            productsToDisplay.forEach(product => {
                const productCard = document.createElement('div');
                productCard.className = 'product-card';
                productCard.setAttribute('data-product-id', product.id);

                productCard.innerHTML = `
                    <div class="product-card-header" onclick="toggleProductCard('${product.id}')">
                        <h3 class="product-name">${product.name || 'N/A'}</h3>
                        <div class="product-price">${product.price !== null && product.price !== undefined ? `R$ ${product.price.toFixed(2)}` : 'N/A'}</div>
                        <svg class="expand-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                        </svg>
                        <div class="product-date-status ${getProductDateStatus(product.createdAt, product.updatedAt)}"></div>
                    </div>
                    <div class="product-details">
                        <div class="product-details-content">
                            <div class="detail-row">
                                <span class="detail-label">Categoria:</span>
                                <span class="detail-value">${product.category || 'N/A'}</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">Marca:</span>
                                <span class="detail-value">${product.brand || 'N/A'}</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">Detalhes:</span>
                                <span class="detail-value">${product.details || 'N/A'}</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">Medida:</span>
                                <span class="detail-value">${product.measure || 'N/A'}</span>
                            </div>
                            <div class="product-actions">
                                <button onclick="editProduct('${product.id}')" class="secondary">Editar</button>
                                <button onclick="deleteProduct('${product.id}')" class="danger">Excluir</button>
                            </div>
                        </div>
                    </div>
                `;
                productList.appendChild(productCard);
            });
        }

        function saveProduct() {
            const id = document.getElementById('productId').value;
            const name = document.getElementById('productName').value.trim();
            const category = document.getElementById('productCategory').value.trim();
            const brand = document.getElementById('productBrand').value.trim();
            const details = document.getElementById('productDetails').value.trim();
            const measure = document.getElementById('productMeasure').value.trim();
            const price = parseFloat(document.getElementById('productPrice').value);

            if (!name) {
                showMessage('O nome do produto é obrigatório!', 'error');
                return;
            }
            if (isNaN(price)) {
                showMessage('O preço deve ser um número válido!', 'error');
                return;
            }

            let productIndex = -1;
            if (id) {
                productIndex = products.findIndex(p => p.id === id);
            } else {
                productIndex = products.findIndex(p => p.name.toLowerCase() === name.toLowerCase());
            }

            if (productIndex > -1) {
                const createdAt = products[productIndex].createdAt;
                products[productIndex] = {
                    id: products[productIndex].id,
                    name: name,
                    category: category || null,
                    brand: brand || null,
                    details: details || null,
                    measure: measure || null,
                    price: price,
                    createdAt: createdAt,
                    updatedAt: new Date().toISOString()
                };
                showMessage('Produto atualizado com sucesso!');
            } else {
                const newProduct = {
                    id: generateId(),
                    name: name,
                    category: category || null,
                    brand: brand || null,
                    details: details || null,
                    measure: measure || null,
                    price: price,
                    createdAt: new Date().toISOString(),
                    updatedAt: null
                };
                products.push(newProduct);
                showMessage('Produto adicionado com sucesso!');
            }

            saveProducts();
            clearForm();
            searchProducts();
            showSection('consultation');
        }

        function editProduct(id) {
            const product = products.find(p => p.id === id);
            if (product) {
                document.getElementById('productId').value = product.id;
                document.getElementById('productName').value = product.name;
                document.getElementById('productCategory').value = product.category || '';
                document.getElementById('productBrand').value = product.brand || '';
                document.getElementById('productDetails').value = product.details || '';
                document.getElementById('productMeasure').value = product.measure || '';
                document.getElementById('productPrice').value = product.price;
                showSection('registration');
            }
        }

        function deleteProduct(id) {
            const confirmationModal = document.createElement('div');
            confirmationModal.className = 'fixed inset-0 bg-gray-900 bg-opacity-75 flex items-center justify-center z-50';
            confirmationModal.innerHTML = `
                <div class="bg-white p-6 rounded-lg shadow-xl max-w-sm w-full text-center">
                    <p class="mb-4 text-lg font-semibold">Tem certeza que deseja excluir este produto?</p>
                    <div class="flex justify-around gap-4">
                        <button class="bg-red-500 hover:bg-red-700 text-white font-bold py-2 px-4 rounded" id="confirmDeleteBtn">Sim, Excluir</button>
                        <button class="bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-2 px-4 rounded" id="cancelDeleteBtn">Cancelar</button>
                    </div>
                </div>
            `;
            document.body.appendChild(confirmationModal);

            document.getElementById('confirmDeleteBtn').onclick = () => {
                products = products.filter(p => p.id !== id);
                saveProducts();
                searchProducts();
                showMessage('Produto excluído com sucesso!');
                confirmationModal.remove();
            };

            document.getElementById('cancelDeleteBtn').onclick = () => {
                confirmationModal.remove();
            };
        }

        function clearForm() {
            document.getElementById('productId').value = '';
            document.getElementById('productName').value = '';
            document.getElementById('productCategory').value = '';
            document.getElementById('productBrand').value = '';
            document.getElementById('productDetails').value = '';
            document.getElementById('productMeasure').value = '';
            document.getElementById('productPrice').value = '';
        }

        function getSearchByValue() {
            const radioButtons = document.querySelectorAll('input[type="radio"][name="searchBy"]');
            for (const radioButton of radioButtons) {
                if (radioButton.checked) {
                    return radioButton.value;
                }
            }
            return null;
        }

        function searchProducts() {
            const searchBarValue = document.getElementById('searchBar').value.toLowerCase();
            const searchBy = getSearchByValue();

            let filteredProducts = products;

            if (searchBarValue.trim()) {
                filteredProducts = products.filter(product => {
                    switch (searchBy) {
                        case 'name':
                            return product.name && product.name.toLowerCase().includes(searchBarValue);
                        case 'category':
                            return product.category && product.category.toLowerCase().includes(searchBarValue);
                        case 'details':
                            return product.details && product.details.toLowerCase().includes(searchBarValue);
                        default:
                            return false;
                    }
                });
            }

            displayProducts(filteredProducts);
        }

        function exportData() {
            const dataStr = JSON.stringify(products, null, 4);
            const blob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'produtos.json';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            showMessage('Dados exportados com sucesso!');
        }

        function importData() {
            const fileInput = document.getElementById('importFile');
            const file = fileInput.files[0];

            if (!file) {
                showMessage('Por favor, selecione um arquivo JSON para importar.', 'error');
                return;
            }

            const reader = new FileReader();
            reader.onload = function (event) {
                try {
                    const importedProducts = JSON.parse(event.target.result);
                    let productsMerged = 0;
                    let productsAdded = 0;

                    importedProducts.forEach(importedProduct => {
                        const importedProductNameLower = (importedProduct.name || '').toLowerCase();
                        const existingProductIndex = products.findIndex(p => (p.name || '').toLowerCase() === importedProductNameLower);

                        if (existingProductIndex > -1) {
                            products[existingProductIndex] = {
                                id: products[existingProductIndex].id,
                                name: importedProduct.name || '',
                                category: importedProduct.category || null,
                                brand: importedProduct.brand || null,
                                details: importedProduct.details || null,
                                measure: importedProduct.measure || null,
                                price: importedProduct.price !== null && importedProduct.price !== undefined ? importedProduct.price : 0,
                                createdAt: importedProduct.createdAt,
                                updatedAt: importedProduct.updatedAt
                            };
                            productsMerged++;
                        } else {
                            products.push({
                                id: importedProduct.id || generateId(),
                                name: importedProduct.name || '',
                                category: importedProduct.category || null,
                                brand: importedProduct.brand || null,
                                details: importedProduct.details || null,
                                measure: importedProduct.measure || null,
                                price: importedProduct.price !== null && importedProduct.price !== undefined ? importedProduct.price : 0,
                                createdAt: importedProduct.createdAt,
                                updatedAt: importedProduct.updatedAt
                            });
                            productsAdded++;
                        }
                    });

                    saveProducts();
                    searchProducts();
                    showMessage(`Dados importados com sucesso! ${productsAdded} novos produtos adicionados, ${productsMerged} produtos atualizados.`);
                } catch (e) {
                    showMessage('Erro ao importar dados. Verifique se o arquivo é um JSON válido.', 'error');
                    console.error("Erro ao importar dados:", e);
                }
            };
            reader.readAsText(file);
        }

        function confirmClearData() {
            const confirmationModal = document.createElement('div');
            confirmationModal.className = 'fixed inset-0 bg-gray-900 bg-opacity-75 flex items-center justify-center z-50';
            confirmationModal.innerHTML = `
                <div class="bg-white p-6 rounded-lg shadow-xl max-w-sm w-full text-center">
                    <p class="mb-4 text-lg font-semibold">Esta ação irá apagar TODOS os produtos. Tem certeza?</p>
                    <div class="flex justify-around gap-4">
                        <button class="bg-red-500 hover:bg-red-700 text-white font-bold py-2 px-4 rounded" id="confirmClearBtn">Sim, Limpar</button>
                        <button class="bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-2 px-4 rounded" id="cancelClearBtn">Cancelar</button>
                    </div>
                </div>
            `;
            document.body.appendChild(confirmationModal);

            document.getElementById('confirmClearBtn').onclick = () => {
                products = [];
                saveProducts();
                searchProducts();
                showMessage('Todos os dados foram limpos!', 'success');
                confirmationModal.remove();
            };

            document.getElementById('cancelClearBtn').onclick = () => {
                confirmationModal.remove();
            };
        }

        function showSection(sectionId) {
            document.querySelectorAll('.form-section').forEach(section => {
                section.classList.remove('active');
            });
            document.getElementById(sectionId + 'Section').classList.add('active');

            document.querySelectorAll('.tab-button').forEach(button => {
                button.classList.remove('active');
            });
            document.querySelector(`.tab-button[onclick="showSection('${sectionId}')"]`).classList.add('active');

            if (sectionId === 'consultation') {
                searchProducts();
            }
        }

        function scrollToTop() {
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        }

        function toggleScrollToTopButton() {
            if (window.pageYOffset > 200) {
                scrollToTopBtn.classList.remove('hidden');
                scrollToTopBtn.classList.add('block');
            } else {
                scrollToTopBtn.classList.remove('block');
                scrollToTopBtn.classList.add('hidden');
            }
        }

        window.onload = () => {
            scrollToTopBtn = document.createElement('div');
            scrollToTopBtn.id = 'scrollToTopBtn';
            scrollToTopBtn.className = 'fixed w-fit bottom-4 right-4 bg-blue-500 hover:bg-blue-700 text-white p-3 rounded-full shadow-lg transition-all duration-300 hidden cursor-pointer';
            scrollToTopBtn.innerHTML = `
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 10l7-7m0 0l7 7m-7-7v18" />
                </svg>
            `;
            scrollToTopBtn.onclick = scrollToTop;
            document.body.appendChild(scrollToTopBtn);

            window.addEventListener('scroll', toggleScrollToTopButton);

            const searchBar = document.getElementById('searchBar');
            searchBar.oninput = searchProducts;

            // Adicionar event listeners para os radio buttons
            const radioButtons = document.querySelectorAll('input[type="radio"][name="searchBy"]');
            radioButtons.forEach(radio => {
                radio.addEventListener('change', searchProducts);
            });

            loadProducts();
            showSection('consultation');
        };
    </script>
</body>

</html>